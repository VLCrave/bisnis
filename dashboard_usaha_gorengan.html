<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLCrave Business Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0d1117;
            color: #fff;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #1f6feb;
            padding: 15px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        }
        .container {
            width: 90%;
            max-width: 900px;
            margin: 20px auto;
            background-color: #161b22;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(31, 111, 235, 0.5);
        }
        h2 {
            color: #58a6ff;
            border-bottom: 2px solid #1f6feb;
            padding-bottom: 5px;
        }
        input, button {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border: none;
            font-size: 1rem;
        }
        input {
            width: calc(100% - 20px);
            background-color: #0d1117;
            color: #fff;
            border: 1px solid #30363d;
        }
        button {
            cursor: pointer;
            background-color: #1f6feb;
            color: white;
            transition: 0.3s;
        }
        button:hover {
            background-color: #388bfd;
        }
        table {
            width: 100%;
            margin-top: 10px;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #30363d;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #1f6feb;
            color: white;
        }
        .actions button {
            margin-right: 5px;
            padding: 5px 8px;
            font-size: 0.9rem;
        }
        .summary {
            margin-top: 15px;
            padding: 10px;
            background-color: #21262d;
            border-radius: 5px;
        }
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <header>ðŸ“Š VLCrave Business Page</header>
    <div class="container">
        <h2>ðŸ’° Rincian Modal</h2>
        <input type="text" id="modalName" placeholder="Nama Modal">
        <input type="number" id="modalValue" placeholder="Nominal (Rp)">
        <button onclick="addModal()">Tambah Modal</button>
        <table id="modalTable">
            <thead>
                <tr>
                    <th>Nama Modal</th>
                    <th>Nominal</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <div class="summary">Total Modal: <span id="totalModal">Rp0</span></div>

        <h2>ðŸ“† Rekap Penghasilan Harian</h2>
        <input type="date" id="incomeDate">
        <input type="number" id="incomeValue" placeholder="Nominal Penghasilan (Rp)">
        <button onclick="addIncome()">Tambah Penghasilan</button>
        <table id="incomeTable">
            <thead>
                <tr>
                    <th>Tanggal</th>
                    <th>Nominal</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <div class="summary">Total Penghasilan: <span id="totalIncome">Rp0</span></div>

        <h2>ðŸ“ˆ Laporan Laba/Rugi</h2>
        <div class="summary">
            <p>Total Modal: <span id="reportModal">Rp0</span></p>
            <p>Total Penghasilan: <span id="reportIncome">Rp0</span></p>
            <p>Laba/Rugi: <span id="reportProfit">Rp0</span></p>
            <p>Persentase Profit: <span id="reportPercent">0%</span></p>
            <p>Net Profit per Hari: <span id="reportNet">Rp0</span></p>
        </div>

        <div class="btn-group">
            <button onclick="shareWhatsApp()">ðŸ“¤ Share WhatsApp</button>
            <button onclick="exportExcel()">ðŸ“¥ Download Excel</button>
        </div>
    </div>

    <script>
        let modalData = JSON.parse(localStorage.getItem('modalData')) || [];
        let incomeData = JSON.parse(localStorage.getItem('incomeData')) || [];

        function formatRupiah(num) {
            return 'Rp' + num.toLocaleString('id-ID');
        }

        function saveData() {
            localStorage.setItem('modalData', JSON.stringify(modalData));
            localStorage.setItem('incomeData', JSON.stringify(incomeData));
        }

        function updateModalTable() {
            const tbody = document.querySelector('#modalTable tbody');
            tbody.innerHTML = '';
            modalData.forEach((item, index) => {
                tbody.innerHTML += `
                    <tr>
                        <td>${item.name}</td>
                        <td>${formatRupiah(item.value)}</td>
                        <td class="actions">
                            <button onclick="editModal(${index})">Edit</button>
                            <button onclick="deleteModal(${index})">Hapus</button>
                        </td>
                    </tr>`;
            });
            document.getElementById('totalModal').innerText = formatRupiah(getTotalModal());
            updateReport();
        }

        function updateIncomeTable() {
            const tbody = document.querySelector('#incomeTable tbody');
            tbody.innerHTML = '';
            incomeData.forEach((item, index) => {
                tbody.innerHTML += `
                    <tr>
                        <td>${item.date}</td>
                        <td>${formatRupiah(item.value)}</td>
                        <td class="actions">
                            <button onclick="editIncome(${index})">Edit</button>
                            <button onclick="deleteIncome(${index})">Hapus</button>
                        </td>
                    </tr>`;
            });
            document.getElementById('totalIncome').innerText = formatRupiah(getTotalIncome());
            updateReport();
        }

        function getTotalModal() {
            return modalData.reduce((a, b) => a + b.value, 0);
        }

        function getTotalIncome() {
            return incomeData.reduce((a, b) => a + b.value, 0);
        }

        function addModal() {
            const name = document.getElementById('modalName').value;
            const value = parseInt(document.getElementById('modalValue').value);
            if (!name || isNaN(value)) return alert('Lengkapi data modal!');
            modalData.push({ name, value });
            document.getElementById('modalName').value = '';
            document.getElementById('modalValue').value = '';
            saveData();
            updateModalTable();
        }

        function editModal(index) {
            const newName = prompt('Edit nama modal:', modalData[index].name);
            const newValue = parseInt(prompt('Edit nominal modal:', modalData[index].value));
            if (newName && !isNaN(newValue)) {
                modalData[index] = { name: newName, value: newValue };
                saveData();
                updateModalTable();
            }
        }

        function deleteModal(index) {
            if (confirm('Hapus modal ini?')) {
                modalData.splice(index, 1);
                saveData();
                updateModalTable();
            }
        }

        function addIncome() {
            const date = document.getElementById('incomeDate').value;
            const value = parseInt(document.getElementById('incomeValue').value);
            if (!date || isNaN(value)) return alert('Lengkapi data penghasilan!');
            incomeData.push({ date, value });
            document.getElementById('incomeDate').value = '';
            document.getElementById('incomeValue').value = '';
            saveData();
            updateIncomeTable();
        }

        function editIncome(index) {
            const newDate = prompt('Edit tanggal:', incomeData[index].date);
            const newValue = parseInt(prompt('Edit nominal penghasilan:', incomeData[index].value));
            if (newDate && !isNaN(newValue)) {
                incomeData[index] = { date: newDate, value: newValue };
                saveData();
                updateIncomeTable();
            }
        }

        function deleteIncome(index) {
            if (confirm('Hapus penghasilan ini?')) {
                incomeData.splice(index, 1);
                saveData();
                updateIncomeTable();
            }
        }

        function updateReport() {
            const totalModal = getTotalModal();
            const totalIncome = getTotalIncome();
            const profit = totalIncome - totalModal;
            const percent = totalModal > 0 ? ((profit / totalModal) * 100).toFixed(2) : 0;
            const netProfit = incomeData.length > 0 ? Math.floor(profit / incomeData.length) : 0;

            document.getElementById('reportModal').innerText = formatRupiah(totalModal);
            document.getElementById('reportIncome').innerText = formatRupiah(totalIncome);
            document.getElementById('reportProfit').innerText = formatRupiah(profit);
            document.getElementById('reportPercent').innerText = percent + '%';
            document.getElementById('reportNet').innerText = formatRupiah(netProfit);
        }

        function shareWhatsApp() {
            const totalModal = formatRupiah(getTotalModal());
            const totalIncome = formatRupiah(getTotalIncome());
            const profit = formatRupiah(getTotalIncome() - getTotalModal());
            const message = `ðŸ“Š *Laporan VLCrave Business Page*%0A%0AðŸ’° Total Modal: ${totalModal}%0AðŸ“ˆ Total Penghasilan: ${totalIncome}%0AðŸ’µ Laba/Rugi: ${profit}`;
            window.open(`https://wa.me/?text=${message}`, '_blank');
        }

        function exportExcel() {
            const ws = XLSX.utils.json_to_sheet([
                ...modalData.map(item => ({ Jenis: "Modal", Nama: item.name, Nominal: item.value })),
                ...incomeData.map(item => ({ Jenis: "Penghasilan", Nama: item.date, Nominal: item.value }))
            ]);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Laporan VLCrave");
            XLSX.writeFile(wb, "Laporan_VLCrave.xlsx");
        }

        updateModalTable();
        updateIncomeTable();
    </script>
</body>
</html>
